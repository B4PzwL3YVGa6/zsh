# Sync config
#
# Usage: rseverywhere [@dt...]
#                     +-- http://clustershell.readthedocs.io/en/latest/tools/nodeset.html

if (($#))
then
   print -P '%F{yellow}Syncing config on these hosts%f:'
   nodeset -r $@
else
   print -P '%F{yellow}Syncing config on all hosts%f:'
   nodeset -ra
fi

echo
read 'REPLY?proceed?: '
[[ $REPLY == (#i)(y|yes) ]] || return 1

while read -r -d ''
do
   print -P "%F{yellow}$REPLY%f"
   rsall $REPLY
done < <(nodeset -e -S'\0' ${@:--a})
